<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Docker Build Script :: Apache Hop</title> <meta name="description" content="The Apache Hop Docker Build Script provides a unified way to build all Hop container images using multi-stage Docker builds."> <meta name="generator" content="Antora 3.0.1"> <link rel="stylesheet" href="../../_/css/site-e3cda5e4ab.css"> <meta property="og:title" content="Docker Build Script :: Apache Hop"> <meta property="og:description" content="The Apache Hop Docker Build Script provides a unified way to build all Hop container images using multi-stage Docker builds."> <meta property="og:type" content="article"> <meta property="og:url" content=""> <meta property="og:image" content="https://hop.apache.org/img/hop-logo.png"> </head> <body class="article"> <header class="header"> <nav class="navbar"> <div class="navbar-brand"> <a class="nav-logo" href="../.."><span>Apache Hop</span></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item mobile-heading" href="/../../blog/">Blog</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link mobile-heading" href="#">Documentation</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../manual/latest/getting-started/">Getting started</a> <a class="navbar-item" href="../../manual/latest/">User manual</a> <a class="navbar-item" href="../../tech-manual/latest/">Technical Documentation</a> <a class="navbar-item" href="../../dev-manual/latest/">Developer Documentation</a> <a class="navbar-item" href="../../docs/architecture/">Architecture</a> <a class="navbar-item" href="../../docs/roadmap/">Roadmap</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link mobile-heading" href="#">Community</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../community/contributing/">Contributing</a> <a class="navbar-item" href="../../community/tools/">Tools</a> <a class="navbar-item" href="../../community/mailing-list/">Mailing Lists</a> <a class="navbar-item" href="../../community/events/">Events and User Groups</a> <a class="navbar-item" href="../../community/team/">Team</a> <a class="navbar-item" href="../../community/support/">Support</a> <a class="navbar-item" href="../../community/ethos/">Ethos</a> </div> </div> <a class="navbar-item mobile-heading" href="/../../download/">Download</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link mobile-heading" href="#">Apache</a> <div class="navbar-dropdown"> <a class="navbar-item" href="https://www.apache.org/events/current-event" target="_blank">Events</a> <a class="navbar-item" href="https://www.apache.org/licenses/" target="_blank">License</a> <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html" target="_blank">Thanks to our sponsors</a> <a class="navbar-item" href="https://www.apache.org/security/" target="_blank">Apache Security</a> <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html" target="_blank">Become a sponsor</a> </div> </div> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-item search hide-for-print"> <div id="search-field" class="field"> <input id="search-input" type="text" placeholder="Search the docs"> </div> </div> <div class="navbar-tools"> <a href="https://twitter.com/ApacheHop" title="Follow us on Twitter" target="_blank"><svg focusable="false" height="30" width="30" viewBox="0 0 30 30" class="brand-icon"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.5 8.778c-.441.196-.916.328-1.414.388.509-.305.898-.787 1.083-1.362-.476.282-1.003.487-1.564.597-.448-.479-1.089-.778-1.796-.778-1.59 0-2.758 1.483-2.399 3.023-2.045-.103-3.86-1.083-5.074-2.572-.645 1.106-.334 2.554.762 3.287-.403-.013-.782-.124-1.114-.308-.027 1.14.791 2.207 1.975 2.445-.346.094-.726.116-1.112.042.313.978 1.224 1.689 2.3 1.709-1.037.812-2.34 1.175-3.647 1.021 1.09.699 2.383 1.106 3.773 1.106 4.572 0 7.154-3.861 6.998-7.324.482-.346.899-.78 1.229-1.274z"/></svg></a> <a href="https://www.linkedin.com/company/apachehop/" title="Follow us on LinkedIn" target="_blank"><svg focusable="false" height="30" width="30" viewBox="0 0 30 30" class="brand-icon"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></a> <a href="https://www.youtube.com/channel/UCGlcYslwe03Y2zbZ1W6DAGA" title="Subscribe to our YouTube channel" target="_blank"><svg focusable="false" height="30" width="30" viewBox="0 0 30 30" class="brand-icon"><path fill-rule="evenodd" d="M4.652 0h1.44l.988 3.702.916-3.702h1.454l-1.665 5.505v3.757h-1.431v-3.757l-1.702-5.505zm6.594 2.373c-1.119 0-1.861.74-1.861 1.835v3.349c0 1.204.629 1.831 1.861 1.831 1.022 0 1.826-.683 1.826-1.831v-3.349c0-1.069-.797-1.835-1.826-1.835zm.531 5.127c0 .372-.19.646-.532.646-.351 0-.554-.287-.554-.646v-3.179c0-.374.172-.651.529-.651.39 0 .557.269.557.651v3.179zm4.729-5.07v5.186c-.155.194-.5.512-.747.512-.271 0-.338-.186-.338-.46v-5.238h-1.27v5.71c0 .675.206 1.22.887 1.22.384 0 .918-.2 1.468-.853v.754h1.27v-6.831h-1.27zm2.203 13.858c-.448 0-.541.315-.541.763v.659h1.069v-.66c.001-.44-.092-.762-.528-.762zm-4.703.04c-.084.043-.167.109-.25.198v4.055c.099.106.194.182.287.229.197.1.485.107.619-.067.07-.092.105-.241.105-.449v-3.359c0-.22-.043-.386-.129-.5-.147-.193-.42-.214-.632-.107zm4.827-5.195c-2.604-.177-11.066-.177-13.666 0-2.814.192-3.146 1.892-3.167 6.367.021 4.467.35 6.175 3.167 6.367 2.6.177 11.062.177 13.666 0 2.814-.192 3.146-1.893 3.167-6.367-.021-4.467-.35-6.175-3.167-6.367zm-12.324 10.686h-1.363v-7.54h-1.41v-1.28h4.182v1.28h-1.41v7.54zm4.846 0h-1.21v-.718c-.223.265-.455.467-.696.605-.652.374-1.547.365-1.547-.955v-5.438h1.209v4.988c0 .262.063.438.322.438.236 0 .564-.303.711-.487v-4.939h1.21v6.506zm4.657-1.348c0 .805-.301 1.431-1.106 1.431-.443 0-.812-.162-1.149-.583v.5h-1.221v-8.82h1.221v2.84c.273-.333.644-.608 1.076-.608.886 0 1.18.749 1.18 1.631v3.609zm4.471-1.752h-2.314v1.228c0 .488.042.91.528.91.511 0 .541-.344.541-.91v-.452h1.245v.489c0 1.253-.538 2.013-1.813 2.013-1.155 0-1.746-.842-1.746-2.013v-2.921c0-1.129.746-1.914 1.837-1.914 1.161 0 1.721.738 1.721 1.914v1.656z"></path></svg></a> <a href="https://github.com/apache/hop/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon" viewBox="0 0 22 22"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <div class="nav-container" data-component="dev-manual" data-version="2.17.0"> <aside class="nav"> <div class="panels"> <div class="nav-panel-menu is-active" data-panel="menu"> <nav class="nav-menu"> <h3 class="title"><a href="index.html">Development Documentation</a></h3> <ul class="nav-list"> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <a class="nav-link" href="getting-started.html">Getting started</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="upgrading-to-20.html">Plugins Upgrades to 2.x</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="porting-kettle-plugins.html">Porting Kettle plugins</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="metadata-plugins.html">Metadata plugins</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="setup-dev-environment.html">Setting up your development environment</a> </li> <li class="nav-item is-current-page" data-depth="1"> <a class="nav-link" href="docker-build.html">Docker Build Script</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="integration-testing.html">Integration testing</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="internationalisation.html">Internationalisation (i18n)</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="plugin-development.html">Plugins Development</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="plugin-samples.html">Plugins Samples</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="svg-files.html">SVG Files</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="start-your-own-plugin.html">Creating your own plugin</a> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <a class="nav-link" href="apache-release/index.html">Apache Release Process</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="apache-release/creating-a-release.html">Creating a Release</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="apache-release/promoting-a-release.html">Promoting a Release</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="apache-release/checking-a-release.html">Checking a Release</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <a class="nav-link" href="hopweb/index.html">Hop Web</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hopweb/developer-guide.html">Hop Web Developer Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hopweb/hopweb-antipatterns.html">Hop Web Antipatterns</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <a class="nav-link" href="sdk/index.html">SDK</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="sdk/hop-sdk.html">The Hop SDK</a> </li> </ul> </li> </ul> </li> </ul> </nav> </div> <div class="nav-panel-explore" data-panel="explore"> <div class="context"> <span class="title">Development Documentation</span> <span class="version">2.17.0</span> </div> <ul class="components"> <li class="component is-current"> <a class="title" href="../latest/index.html">Development Documentation</a> <ul class="versions"> <li class="version is-current"> <a href="index.html">2.17.0</a> </li> <li class="version is-latest"> <a href="../latest/index.html">2.16.0</a> </li> <li class="version"> <a href="../2.15.0/index.html">2.15.0</a> </li> <li class="version"> <a href="../2.14.0/index.html">2.14.0</a> </li> <li class="version"> <a href="../2.13.0/index.html">2.13.0</a> </li> <li class="version"> <a href="../2.12.0/index.html">2.12.0</a> </li> <li class="version"> <a href="../2.11.0/index.html">2.11.0</a> </li> <li class="version"> <a href="../2.10.0/index.html">2.10.0</a> </li> <li class="version"> <a href="../2.9.0/index.html">2.9.0</a> </li> <li class="version"> <a href="../2.8.0/index.html">2.8.0</a> </li> <li class="version"> <a href="../2.7.0/index.html">2.7.0</a> </li> <li class="version"> <a href="../2.6.0/index.html">2.6.0</a> </li> <li class="version"> <a href="../2.5.0/index.html">2.5.0</a> </li> </ul> </li> <li class="component"> <a class="title" href="../../tech-manual/latest/index.html">Technical Documentation</a> <ul class="versions"> <li class="version"> <a href="../../tech-manual/next/index.html">2.17.0</a> </li> <li class="version is-latest"> <a href="../../tech-manual/latest/index.html">2.16.0</a> </li> <li class="version"> <a href="../../tech-manual/2.15.0/index.html">2.15.0</a> </li> <li class="version"> <a href="../../tech-manual/2.14.0/index.html">2.14.0</a> </li> <li class="version"> <a href="../../tech-manual/2.13.0/index.html">2.13.0</a> </li> <li class="version"> <a href="../../tech-manual/2.12.0/index.html">2.12.0</a> </li> <li class="version"> <a href="../../tech-manual/2.11.0/index.html">2.11.0</a> </li> <li class="version"> <a href="../../tech-manual/2.10.0/index.html">2.10.0</a> </li> <li class="version"> <a href="../../tech-manual/2.9.0/index.html">2.9.0</a> </li> <li class="version"> <a href="../../tech-manual/2.8.0/index.html">2.8.0</a> </li> <li class="version"> <a href="../../tech-manual/2.7.0/index.html">2.7.0</a> </li> <li class="version"> <a href="../../tech-manual/2.6.0/index.html">2.6.0</a> </li> <li class="version"> <a href="../../tech-manual/2.5.0/index.html">2.5.0</a> </li> </ul> </li> <li class="component"> <a class="title" href="../../manual/latest/index.html">User manual</a> <ul class="versions"> <li class="version"> <a href="../../manual/next/index.html">2.17.0 (pre-release)</a> </li> <li class="version is-latest"> <a href="../../manual/latest/index.html">2.16.0</a> </li> <li class="version"> <a href="../../manual/2.15.0/index.html">2.15.0</a> </li> <li class="version"> <a href="../../manual/2.14.0/index.html">2.14.0</a> </li> <li class="version"> <a href="../../manual/2.13.0/index.html">2.13.0</a> </li> <li class="version"> <a href="../../manual/2.12.0/index.html">2.12.0</a> </li> <li class="version"> <a href="../../manual/2.11.0/index.html">2.11.0</a> </li> <li class="version"> <a href="../../manual/2.10.0/index.html">2.10.0</a> </li> <li class="version"> <a href="../../manual/2.9.0/index.html">2.9.0</a> </li> <li class="version"> <a href="../../manual/2.8.0/index.html">2.8.0</a> </li> <li class="version"> <a href="../../manual/2.7.0/index.html">2.7.0</a> </li> <li class="version"> <a href="../../manual/2.6.0/index.html">2.6.0</a> </li> <li class="version"> <a href="../../manual/2.5.0/index.html">2.5.0</a> </li> </ul> </li> </ul> </div> </div> </aside> </div> <main class="article"> <nav class="toolbar"> <button class="nav-toggle"></button> <a href="../../manual/latest/index.html" class="home-link"></a> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="index.html">Development Documentation</a></li> <li><a href="docker-build.html">Docker Build Script</a></li> </ul> </nav> <div class="page-versions"> <button class="version-menu-toggle" title="Show other versions of page">2.17.0</button> <div class="version-menu"> <a class="version is-current" href="docker-build.html">2.17.0</a> <a class="version is-missing" href="../latest/index.html">2.16.0</a> <a class="version is-missing" href="../2.15.0/index.html">2.15.0</a> <a class="version is-missing" href="../2.14.0/index.html">2.14.0</a> <a class="version is-missing" href="../2.13.0/index.html">2.13.0</a> <a class="version is-missing" href="../2.12.0/index.html">2.12.0</a> <a class="version is-missing" href="../2.11.0/index.html">2.11.0</a> <a class="version is-missing" href="../2.10.0/index.html">2.10.0</a> <a class="version is-missing" href="../2.9.0/index.html">2.9.0</a> <a class="version is-missing" href="../2.8.0/index.html">2.8.0</a> <a class="version is-missing" href="../2.7.0/index.html">2.7.0</a> <a class="version is-missing" href="../2.6.0/index.html">2.6.0</a> <a class="version is-missing" href="../2.5.0/index.html">2.5.0</a> </div> </div> <div class="edit-this-page"><a href="https://github.com/apache/hop/edit/main/docs/hop-dev-manual/modules/ROOT/pages/docker-build.adoc">Edit this Page</a></div> </nav> <div class="content"> <aside class="toc sidebar" data-title="Contents" data-levels="2"> <div class="toc-menu"></div> </aside> <article class="doc"> <h1 class="page">Docker Build Script</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>The Apache Hop project provides a unified build script (<code>build-hop-images.sh</code>) that can build all Apache Hop Docker images using a multi-stage build approach. This script supports building from local source or from a GitHub tag, with options for multi-platform builds and registry pushing.</p> </div> </div> </div> <div class="sect1"> <h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2> <div class="sectionbody"> <div class="paragraph"> <p>The build script creates the following Docker images:</p> </div> <div class="ulist"> <ul> <li> <p><strong>hop</strong> (client) - The main Apache Hop client/server image based on Alpine Linux</p> </li> <li> <p><strong>hop-web</strong> - Apache Hop Web interface running on Tomcat</p> </li> <li> <p><strong>hop-web-beam</strong> - Hop Web variant with Apache Beam fat jar for Google Cloud Dataflow integration</p> </li> <li> <p><strong>hop-dataflow-template</strong> - Google Cloud Dataflow Flex Template image</p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_build_architecture"><a class="anchor" href="#_build_architecture"></a>Build Architecture</h2> <div class="sectionbody"> <div class="paragraph"> <p>The build process uses a unified multi-stage Dockerfile that shares common build stages across all images, reducing build time and ensuring consistency.</p> </div> <div class="literalblock"> <div class="content"> <pre>flowchart TB
    subgraph Source["Stage 1: Source Preparation"]
        SG[source-github&lt;br/&gt;Clone from GitHub]
        SL[Local Source&lt;br/&gt;From build context]
    end

    subgraph Builder["Stage 2: Builder"]
        BF[builder-full&lt;br/&gt;Maven build from source]
        BFast[builder-fast&lt;br/&gt;Pre-built artifacts]
    end

    subgraph Prep["Stage 3: Preparation"]
        BP[builder&lt;br/&gt;Extract &amp; prepare artifacts&lt;br/&gt;Generate fat jar]
    end

    subgraph Final["Stage 4: Final Images"]
        IC["client&lt;br/&gt;Alpine + JRE&lt;br/&gt;&amp;lt;registry&amp;gt;/hop:&amp;lt;version&amp;gt;"]
        IW["web&lt;br/&gt;Tomcat&lt;br/&gt;&amp;lt;registry&amp;gt;/hop-web:&amp;lt;version&amp;gt;"]
        IWB["web-beam&lt;br/&gt;Tomcat + fat jar&lt;br/&gt;&amp;lt;registry&amp;gt;/hop-web:&amp;lt;version&amp;gt;-beam"]
        ID["dataflow&lt;br/&gt;GCP Dataflow base&lt;br/&gt;&amp;lt;registry&amp;gt;/hop-dataflow-template:&amp;lt;version&amp;gt;"]
    end

    SG --&gt; BF
    SL --&gt; BFast
    BF --&gt; BP
    BFast --&gt; BP
    BP --&gt; IC
    BP --&gt; IW
    BP --&gt; ID
    IW --&gt; IWB

    style SG fill:#e1f5fe
    style SL fill:#e1f5fe
    style BF fill:#fff3e0
    style BFast fill:#fff3e0
    style BP fill:#f3e5f5
    style IC fill:#e8f5e9
    style IW fill:#e8f5e9
    style IWB fill:#c8e6c9
    style ID fill:#e8f5e9</pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2> <div class="sectionbody"> <div class="paragraph"> <p>Before using the build script, ensure you have:</p> </div> <div class="ulist"> <ul> <li> <p><strong>Docker</strong> - Version 20.10 or higher</p> </li> <li> <p><strong>Docker Buildx</strong> - Required only for multi-platform builds (usually included with Docker Desktop)</p> </li> <li> <p><strong>Maven</strong> - Only if building locally before using <code>--builder fast</code></p> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_command_line_arguments"><a class="anchor" href="#_command_line_arguments"></a>Command Line Arguments</h2> <div class="sectionbody"> <div class="paragraph"> <p>The build script supports the following arguments:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 25%;"> <col style="width: 12.5%;"> <col style="width: 37.5%;"> <col style="width: 25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Argument</th> <th class="tableblock halign-left valign-top">Short</th> <th class="tableblock halign-left valign-top">Description</th> <th class="tableblock halign-left valign-top">Default</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--source &lt;type&gt;</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-s</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Build from <code>local</code> source or <code>github</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--tag &lt;tag&gt;</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-t</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Git tag or branch to build from (when using <code>--source github</code>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>main</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--repo &lt;url&gt;</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-r</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">GitHub repository URL</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="https://github.com/apache/hop.git" class="bare">https://github.com/apache/hop.git</a></code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--images &lt;list&gt;</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-i</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of images to build, or <code>all</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>all</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--version &lt;version&gt;</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-v</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Version string for image tagging</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Auto-detected from pom.xml</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--push</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-p</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Push images to registry after build</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--registry &lt;registry&gt;</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-x</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Docker registry prefix (e.g., <code>apache</code>, <code>myregistry.io/myorg</code>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">None (local only)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--platforms &lt;platforms&gt;</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Build platforms (e.g., <code>linux/amd64,linux/arm64</code>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Current system platform</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--maven-threads &lt;threads&gt;</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Maven build parallelism (e.g., <code>1C</code>, <code>2C</code>, <code>4</code>)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>1C</code> (1 thread per CPU core)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--progress &lt;mode&gt;</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Docker build output: <code>auto</code>, <code>plain</code> (verbose), <code>tty</code> (compact)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>auto</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--builder &lt;type&gt;</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Builder type: <code>full</code> (Maven build) or <code>fast</code> (pre-built artifacts)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>full</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--no-cache</code></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Build without using Docker cache</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Cache enabled</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--help</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>-h</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Show help message</p></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table> </div> </div> <div class="sect1"> <h2 id="_available_image_stages"><a class="anchor" href="#_available_image_stages"></a>Available Image Stages</h2> <div class="sectionbody"> <div class="paragraph"> <p>The following image stages can be specified with the <code>--images</code> argument:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 16.6666%;"> <col style="width: 33.3333%;"> <col style="width: 50.0001%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Stage</th> <th class="tableblock halign-left valign-top">Image Name</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>client</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>hop</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Main Hop client/server image. Based on Alpine Linux with OpenJDK 17. Can run pipelines, workflows, and Hop Server.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>web</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>hop-web</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Hop Web interface running on Apache Tomcat 10. Provides browser-based access to the Hop GUI.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>web-beam</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>hop-web</code> (variant)</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Hop Web with Apache Beam fat jar included. Use for Google Cloud Dataflow integration. Tagged with <code>-beam</code> suffix.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>dataflow</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>hop-dataflow-template</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Google Cloud Dataflow Flex Template image. Contains only the fat jar for running Hop pipelines on Dataflow.</p></td> </tr> </tbody> </table> </div> </div> <div class="sect1"> <h2 id="_builder_types"><a class="anchor" href="#_builder_types"></a>Builder Types</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_full_builder_default"><a class="anchor" href="#_full_builder_default"></a>Full Builder (Default)</h3> <div class="paragraph"> <p>The <code>full</code> builder performs a complete Maven build from source:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --builder full</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p>Clones source code</p> </li> <li> <p>Runs full Maven build with all dependencies</p> </li> <li> <p>Slower but ensures everything is built from scratch</p> </li> <li> <p>Required for CI/CD and release builds</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="_fast_builder"><a class="anchor" href="#_fast_builder"></a>Fast Builder</h3> <div class="paragraph"> <p>The <code>fast</code> builder uses pre-built artifacts, skipping Maven:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># First, build with Maven locally
mvn clean install -DskipTests

# Then build Docker images using pre-built artifacts (only Hop-web in this example)
./build-hop-images.sh --builder fast --images web</code></pre> </div> </div> <div class="ulist"> <ul> <li> <p>Requires <code>mvn clean install</code> to be run first</p> </li> <li> <p>Much faster for local development iteration</p> </li> <li> <p>Copies artifacts directly from <code>target/</code> folders</p> </li> </ul> </div> </div> </div> </div> <div class="sect1"> <h2 id="_image_tagging"><a class="anchor" href="#_image_tagging"></a>Image Tagging</h2> <div class="sectionbody"> <div class="paragraph"> <p>Images are automatically tagged based on the version:</p> </div> <div class="ulist"> <ul> <li> <p><strong>SNAPSHOT versions</strong> (e.g., <code>2.17.0-SNAPSHOT</code>):</p> <div class="ulist"> <ul> <li> <p>Primary tag: <code>hop-web:2.17.0-SNAPSHOT</code></p> </li> <li> <p>Alias tag: <code>hop-web:Development</code></p> </li> </ul> </div> </li> <li> <p><strong>Release versions</strong> (e.g., <code>2.17.0</code>):</p> <div class="ulist"> <ul> <li> <p>Primary tag: <code>hop-web:2.17.0</code></p> </li> <li> <p>Alias tag: <code>hop-web:latest</code></p> </li> </ul> </div> </li> <li> <p><strong>Variant images</strong> get suffix added:</p> <div class="ulist"> <ul> <li> <p>Primary tag: <code>hop-web:2.17.0-SNAPSHOT-beam</code></p> </li> <li> <p>Alias tag: <code>hop-web:Development-beam</code></p> </li> </ul> </div> </li> </ul> </div> </div> </div> <div class="sect1"> <h2 id="_examples"><a class="anchor" href="#_examples"></a>Examples</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_basic_usage"><a class="anchor" href="#_basic_usage"></a>Basic Usage</h3> <div class="paragraph"> <p>Build all images from local source:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_build_specific_images"><a class="anchor" href="#_build_specific_images"></a>Build Specific Images</h3> <div class="paragraph"> <p>Build only the web and client images:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --images client,web</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_build_from_github_release"><a class="anchor" href="#_build_from_github_release"></a>Build from GitHub Release</h3> <div class="paragraph"> <p>Build version 2.9.0 from GitHub:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --source github --tag 2.9.0</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_fast_development_build"><a class="anchor" href="#_fast_development_build"></a>Fast Development Build</h3> <div class="paragraph"> <p>For quick iteration during development:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Build project with Maven first
mvn clean install -DskipTests

# Fast Docker build (skips Maven, uses pre-built artifacts)
./build-hop-images.sh --builder fast --images web</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_multi_platform_build_with_push"><a class="anchor" href="#_multi_platform_build_with_push"></a>Multi-Platform Build with Push</h3> <div class="paragraph"> <p>Build for AMD64 and ARM64, then push to Docker Hub:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh \
    --platforms linux/amd64,linux/arm64 \
    --push \
    --registry apache \
    --version 2.9.0</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_build_web_with_beam_variant"><a class="anchor" href="#_build_web_with_beam_variant"></a>Build Web with Beam Variant</h3> <div class="paragraph"> <p>Build the web image with Apache Beam fat jar for Dataflow:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --images web-beam --registry myregistry</code></pre> </div> </div> <div class="paragraph"> <p>This creates:</p> </div> <div class="ulist"> <ul> <li> <p><code>myregistry/hop-web:2.17.0-SNAPSHOT-beam</code></p> </li> <li> <p><code>myregistry/hop-web:Development-beam</code></p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="_verbose_build_output"><a class="anchor" href="#_verbose_build_output"></a>Verbose Build Output</h3> <div class="paragraph"> <p>See detailed build progress:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --progress plain --images client</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_build_without_cache"><a class="anchor" href="#_build_without_cache"></a>Build Without Cache</h3> <div class="paragraph"> <p>Force a fresh build without using cached layers:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --no-cache --images web</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_configuration_file"><a class="anchor" href="#_configuration_file"></a>Configuration File</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can create a <code>build.env</code> file in the <code>docker/</code> directory to set default values:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># docker/build.env
REGISTRY=myregistry.io/myorg
PLATFORMS=linux/amd64,linux/arm64
PUSH=true
MAVEN_THREADS=2C</code></pre> </div> </div> <div class="paragraph"> <p>Command line arguments override values from <code>build.env</code>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>Troubleshooting</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_build_fails_with_pom_xml_not_found"><a class="anchor" href="#_build_fails_with_pom_xml_not_found"></a>Build Fails with "pom.xml not found"</h3> <div class="paragraph"> <p>Ensure you&#8217;re running the script from the repository root or the <code>docker/</code> directory:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd /path/to/hop
./docker/build-hop-images.sh</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_multi_platform_build_fails"><a class="anchor" href="#_multi_platform_build_fails"></a>Multi-Platform Build Fails</h3> <div class="paragraph"> <p>Multi-platform builds require Docker Buildx:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Check if buildx is available
docker buildx version

# Create a builder if needed
docker buildx create --use --name hop-builder</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_out_of_memory_during_maven_build"><a class="anchor" href="#_out_of_memory_during_maven_build"></a>Out of Memory During Maven Build</h3> <div class="paragraph"> <p>Increase Maven memory by setting threads lower:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --maven-threads 1</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_images_not_appearing_locally_after_multi_platform_build"><a class="anchor" href="#_images_not_appearing_locally_after_multi_platform_build"></a>Images Not Appearing Locally After Multi-Platform Build</h3> <div class="paragraph"> <p>Multi-platform builds require <code>--push</code> or won&#8217;t load locally. For local testing, use single platform:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Single platform (loads locally)
./build-hop-images.sh --platforms linux/amd64

# Multi-platform requires push
./build-hop-images.sh --platforms linux/amd64,linux/arm64 --push --registry myregistry</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_adding_a_new_image_variant"><a class="anchor" href="#_adding_a_new_image_variant"></a>Adding a New Image Variant</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can extend the build system by adding new image variants. Variants are images that extend a base image with additional features. For example, <code>web-beam</code> extends the <code>web</code> image with the Apache Beam fat jar.</p> </div> <div class="paragraph"> <p>This section demonstrates how to add a hypothetical <code>client-debug</code> variant that includes additional debugging tools.</p> </div> <div class="sect2"> <h3 id="_step_1_add_the_stage_to_unified_dockerfile"><a class="anchor" href="#_step_1_add_the_stage_to_unified_dockerfile"></a>Step 1: Add the Stage to unified.Dockerfile</h3> <div class="paragraph"> <p>Add a new stage at the end of <code>docker/unified.Dockerfile</code> that extends the base image:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">################################################################################
# Stage: Hop Client with Debug Tools
################################################################################
FROM client AS client-debug
LABEL variant="debug"

# Switch to root to install packages
USER root

# Install debugging tools
RUN apk add --no-cache \
    strace \
    htop \
    vim \
    curl \
    netcat-openbsd

# Add debug-specific environment variables
ENV HOP_OPTIONS="-XX:+AggressiveHeap -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005"

# Expose debug port
EXPOSE 5005

# Switch back to hop user
USER hop</code></pre> </div> </div> <div class="paragraph"> <p>Key points:</p> </div> <div class="ulist"> <ul> <li> <p><strong>Stage name format</strong>: Use <code>&lt;base&gt;-&lt;variant&gt;</code> naming (e.g., <code>client-debug</code>)</p> </li> <li> <p><strong>FROM clause</strong>: Extend the base image (<code>FROM client AS client-debug</code>)</p> </li> <li> <p><strong>LABEL</strong>: Add <code>variant="debug"</code> label for identification</p> </li> <li> <p><strong>Inheritance</strong>: The variant inherits everything from the base image</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="_step_2_register_the_variant_in_build_hop_images_sh"><a class="anchor" href="#_step_2_register_the_variant_in_build_hop_images_sh"></a>Step 2: Register the Variant in build-hop-images.sh</h3> <div class="paragraph"> <p>Add the new variant to the <code>ALL_STAGES</code> array at the top of <code>docker/build-hop-images.sh</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Available image stages (add new stages here)
# Format: "baseImage" or "baseImage-variant"
ALL_STAGES=("client" "client-debug" "web" "web-beam" "dataflow")</code></pre> </div> </div> <div class="paragraph"> <p>The build script automatically handles:</p> </div> <div class="ulist"> <ul> <li> <p><strong>Image naming</strong>: <code>client-debug</code> â†’ image name <code>hop</code> (from base <code>client</code>)</p> </li> <li> <p><strong>Tag suffix</strong>: Version tag gets <code>-debug</code> suffix (e.g., <code>hop:2.17.0-SNAPSHOT-debug</code>)</p> </li> <li> <p><strong>Alias tags</strong>: Development/latest tags also get suffix (e.g., <code>hop:Development-debug</code>)</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="_step_3_build_and_test_the_variant"><a class="anchor" href="#_step_3_build_and_test_the_variant"></a>Step 3: Build and Test the Variant</h3> <div class="paragraph"> <p>Build only the new variant:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --images client-debug --registry myregistry</code></pre> </div> </div> <div class="paragraph"> <p>This produces:</p> </div> <div class="ulist"> <ul> <li> <p><code>myregistry/hop:2.17.0-SNAPSHOT-debug</code></p> </li> <li> <p><code>myregistry/hop:Development-debug</code></p> </li> </ul> </div> <div class="paragraph"> <p>Build all images including the new variant:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./build-hop-images.sh --images all</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_how_variant_detection_works"><a class="anchor" href="#_how_variant_detection_works"></a>How Variant Detection Works</h3> <div class="paragraph"> <p>The build script uses these functions to handle variants:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Extracts base image name from stage name
get_image_name() {
    local stage_name="$1"
    case "$stage_name" in
        client*)   echo "hop" ;;
        web*)      echo "hop-web" ;;
        dataflow*) echo "hop-dataflow-template" ;;
        *)         echo "" ;;
    esac
}

# Extracts variant suffix (everything after first hyphen)
get_variant_suffix() {
    local stage_name="$1"
    if [[ "$stage_name" == *"-"* ]]; then
        echo "${stage_name#*-}"  # Returns "debug" from "client-debug"
    else
        echo ""
    fi
}</code></pre> </div> </div> <div class="paragraph"> <p>For a new base image type (not a variant of existing), you would also need to update the <code>get_image_name()</code> function.</p> </div> </div> </div> </div> </article> </div> </main> </div> <footer> <div class="footer"> <dl> <dt>Overview</dt> <dd><a href="../../download/">Download</a></dd> <dd><a href="../../manual/latest/">Getting started</a></dd> </dl> <dl> <dt>Community</dt> <dd><a target="_blank" href="https://github.com/apache/hop/issues">GitHub Issues</a></dd> <dd><a target="_blank" href="https://github.com/apache/hop/discussions">GitHub Discussions</a></dd> <dd><a target="_blank" href="../../community/team/">Team</a></dd> </dl> <dl> <dt>About</dt> <dd><a target="_blank" href="https://www.apache.org/licenses/" title="License">License</a></dd> </dl> <p> &copy; 2019-2026 The Hop Team.<br> All marks mentioned may be trademarks or registered trademarks of their respective owners. </p> </div> </footer> <script src="../../_/js/site-8bbb7a5250.js"></script> <script async src="../../_/js/vendor/highlight-a243a7d07e.js"></script> <script async src="../../_/js/vendor/tabs-523d9bca0f.js"></script> <script src="../../_/js/vendor/lunr.js"></script> <script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script> <script async src="../../search-index.js"></script> <!-- Matomo --> <script> var _paq = window._paq = window._paq || [];
  /* We explicitly disable cookie tracking to avoid privacy issues */
  _paq.push(['disableCookies']);  
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://analytics.apache.org/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '11']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })(); </script> <!-- End Matomo Code --> </body> </html> 